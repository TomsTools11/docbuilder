<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Account - DocBuilder</title>
  <meta name="description" content="Manage your DocBuilder account settings and preferences.">
  <meta name="theme-color" content="#1F1F1F">

  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìÑ</text></svg>">

  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Skip to main content for accessibility -->
  <a href="#main" class="skip-link">Skip to main content</a>

  <header class="header" role="banner">
    <div class="container">
      <a href="/" class="logo" aria-label="DocBuilder Home">
        <img src="tt9.svg" alt="DocBuilder" class="logo-icon" height="32">
      </a>
      <nav class="nav" role="navigation">
        <a href="index.html#tools" class="nav-link">Tools</a>
        <a href="index.html#how-it-works" class="nav-link">How It Works</a>
        <a href="index.html#features" class="nav-link">Features</a>
        <span class="nav-divider" aria-hidden="true"></span>
        <a href="https://tom-panos.com" class="nav-link nav-link-external">Home</a>
        <a href="https://tom-panos.com/toms-projects" class="nav-link nav-link-external">More Projects</a>
      </nav>

      <!-- Auth Section -->
      <div class="header__auth">
        <div id="auth-login" class="auth-buttons">
          <button onclick="netlifyIdentity.open('login')" class="btn-auth-secondary">Log In</button>
          <button onclick="netlifyIdentity.open('signup')" class="btn-auth-primary">Sign Up</button>
        </div>
        <div id="auth-user" class="auth-user" style="display: none;">
          <a href="account.html" class="btn-auth-account">My Account</a>
          <button onclick="netlifyIdentity.logout()" class="btn-auth-secondary">Log Out</button>
        </div>
      </div>
    </div>
  </header>

  <main id="main" class="account-page" role="main">
    <!-- Account Hero -->
    <section class="account-hero">
      <div class="container">
        <h1 class="account-hero-title">My Account</h1>
        <p class="account-hero-subtitle">Manage your DocBuilder account</p>
      </div>
    </section>

    <!-- Account Content -->
    <section class="account-content">
      <div class="container">
        <!-- Logged In State -->
        <div id="account-logged-in" class="account-card" style="display: none;">
          <h2 class="account-card-title">Account Details</h2>

          <div class="account-info-row">
            <span class="account-info-label">Email</span>
            <span id="account-email" class="account-info-value">‚Äî</span>
          </div>

          <div class="account-info-row">
            <span class="account-info-label">Name</span>
            <span id="account-name" class="account-info-value">‚Äî</span>
          </div>

          <div class="account-info-row">
            <span class="account-info-label">Member Since</span>
            <span id="account-created" class="account-info-value">‚Äî</span>
          </div>

          <div class="account-actions">
            <button onclick="netlifyIdentity.logout()" class="btn-logout">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                <polyline points="16 17 21 12 16 7"/>
                <line x1="21" y1="12" x2="9" y2="12"/>
              </svg>
              Log Out
            </button>
          </div>
        </div>

        <!-- Not Logged In State -->
        <div id="account-not-logged-in" class="account-card account-not-logged-in">
          <p>Please log in to view your account details.</p>
          <button onclick="netlifyIdentity.open('login')" class="btn btn-primary">
            Log In
          </button>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer" role="contentinfo">
    <div class="container footer-container">
      <a href="/" class="footer-logo" aria-label="DocBuilder Home">
        <img src="docbuilder-logo.svg" alt="DocBuilder" height="24">
      </a>
      <p class="footer-text">Made with <span aria-label="love">‚ù§Ô∏è</span> by <a href="https://tom-panos.com" target="_blank" rel="noopener noreferrer">Tom</a> in Milwaukee, WI</p>
    </div>
  </footer>

  <!-- Netlify Identity Widget -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  <script>
    netlifyIdentity.on('init', function(user) {
      if (user) {
        showAccountDetails(user);
      } else {
        showNotLoggedIn();
      }
    });

    netlifyIdentity.on('login', function(user) {
      showAccountDetails(user);
      netlifyIdentity.close();
    });

    netlifyIdentity.on('logout', function() {
      showNotLoggedIn();
      window.location.href = 'index.html';
    });

    function showAccountDetails(user) {
      // Update header auth state
      document.getElementById('auth-login').style.display = 'none';
      document.getElementById('auth-user').style.display = 'flex';

      // Show account card
      document.getElementById('account-logged-in').style.display = 'block';
      document.getElementById('account-not-logged-in').style.display = 'none';

      // Populate account details
      document.getElementById('account-email').textContent = user.email || '‚Äî';

      var userName = user.user_metadata && user.user_metadata.full_name
        ? user.user_metadata.full_name
        : 'Not set';
      document.getElementById('account-name').textContent = userName;

      var createdDate = user.created_at
        ? new Date(user.created_at).toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
          })
        : '‚Äî';
      document.getElementById('account-created').textContent = createdDate;
    }

    function showNotLoggedIn() {
      // Update header auth state
      document.getElementById('auth-login').style.display = 'flex';
      document.getElementById('auth-user').style.display = 'none';

      // Show not logged in message
      document.getElementById('account-logged-in').style.display = 'none';
      document.getElementById('account-not-logged-in').style.display = 'block';
    }
  </script>
</body>
</html>
